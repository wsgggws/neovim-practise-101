# 代码片段 (Snippets)

## 124. 基础代码片段使用

**场景**：使用 snippets 快速生成常用代码结构

**JavaScript 函数片段**

**触发词**：`fn` + `Tab`

**初始**：

```javascript
|  ← 光标位置
```

**目标**：

```javascript
function functionName(params) {
  // 函数体
}
```

**操作提示**：

- 在 LazyVim 中使用 LuaSnip
- 输入触发词后按 `Tab` 展开
- `Tab` / `Shift-Tab` 在占位符间跳转
- `Ctrl-k` / `Ctrl-j` 在某些配置中也可用

## 125. 条件语句片段

**场景**：快速创建 if/else、switch 等控制结构

**If 语句片段**

**触发词**：`if` + `Tab`

**目标**：

```javascript
if (condition) {
  // true 分支
}
```

**For 循环片段**

**触发词**：`for` + `Tab`

**目标**：

```javascript
for (let i = 0; i < array.length; i++) {
  const element = array[i];
}
```

**常用触发词**：

- `if` - if 语句
- `ife` - if...else
- `elif` - else if
- `switch` - switch 语句
- `for` - for 循环
- `fori` - 带索引的 for 循环
- `foreach` - forEach 循环
- `while` - while 循环

## 126. 类和对象片段

**场景**：快速创建类定义和对象结构

**类定义片段**

**触发词**：`class` + `Tab`

**目标**：

```javascript
class ClassName {
  constructor(params) {
    this.params = params;
  }

  methodName() {}
}
```

**对象片段**

**触发词**：`obj` + `Tab`

**目标**：

```javascript
const obj = {
  key: "value",
};
```

## 127. 导入和导出片段

**场景**：快速添加 import/export 语句

**Import 片段**

**触发词**：`imp` + `Tab`

**目标**：

```javascript
import { module } from "package";
```

**常用导入片段**：

- `imp` - import 导入
- `imn` - import 整个模块
- `imd` - import 默认
- `ime` - import everything as
- `ima` - import as

**Export 片段**：

- `exp` - export default
- `exn` - named export
- `exc` - export const

## 128. 异步代码片段

**场景**：创建 Promise、async/await 结构

**Promise 片段**

**触发词**：`promise` + `Tab`

**目标**：

```javascript
new Promise((resolve, reject) => {});
```

**Async 函数片段**

**触发词**：`afn` + `Tab`

**目标**：

```javascript
async function functionName(params) {
  try {
    const result = await asyncOperation();
    return result;
  } catch (error) {
    console.error(error);
  }
}
```

**Try-Catch 片段**

**触发词**：`try` + `Tab`

**目标**：

```javascript
try {
} catch (error) {
  console.error(error);
}
```

## 129. React 组件片段

**场景**：快速创建 React 组件

**函数组件片段**

**触发词**：`rfc` + `Tab`

**目标**：

```javascript
import React from "react";

function ComponentName() {
  return <div></div>;
}

export default ComponentName;
```

**带 Props 的组件**

**触发词**：`rfcp` + `Tab`

**目标**：

```javascript
import React from "react";

function ComponentName({ prop1, prop2 }) {
  return <div>{prop1}</div>;
}

export default ComponentName;
```

**常用 React 片段**：

- `rfc` - React 函数组件
- `rfce` - React 函数组件带 export
- `rafce` - React 箭头函数组件
- `useS` - useState hook
- `useE` - useEffect hook
- `useC` - useContext hook
- `useR` - useReducer hook

## 130. Console 和调试片段

**场景**：快速插入调试语句

**Console.log 片段**

**触发词**：`clg` + `Tab`

**目标**：

```javascript
console.log("variable:", variable);
```

**常用调试片段**：

- `clg` - console.log
- `clo` - console.log 对象
- `clj` - console.log JSON
- `clt` - console.table
- `cle` - console.error
- `clw` - console.warn
- `cld` - console.dir
- `debugger` - debugger 语句

## 131. 注释和文档片段

**场景**：生成函数文档和注释

**JSDoc 函数注释**

**触发词**：`/**` + `Enter`

**目标**：

```javascript
/**
 * 函数描述
 * @param {type} paramName - 参数描述
 * @returns {type} 返回值描述
 */
function functionName(paramName) {}
```

**TODO 注释**

**触发词**：`todo` + `Tab`

**目标**：

```javascript
// TODO: 待办事项描述
```

**常用注释片段**：

- `/**` - JSDoc 注释
- `todo` - TODO 注释
- `fixme` - FIXME 注释
- `note` - NOTE 注释
- `hack` - HACK 注释

## 132. 测试代码片段

**场景**：快速创建测试用例

**Describe 块**

**触发词**：`desc` + `Tab`

**目标**：

```javascript
describe("TestSuite", () => {
  it("should do something", () => {
    expect(actual).toBe(expected);
  });
});
```

**It 测试用例**

**触发词**：`it` + `Tab`

**目标**：

```javascript
it("should do something", () => {
  // Arrange
  const input = "test";

  // Act
  const result = functionUnderTest(input);

  // Assert
  expect(result).toBe(expected);
});
```

**常用测试片段**：

- `desc` - describe 块
- `it` - it 测试用例
- `test` - test 函数
- `beforeEach` - beforeEach 钩子
- `afterEach` - afterEach 钩子
- `expect` - expect 断言

## 133. HTML 片段

**场景**：快速创建 HTML 结构

**HTML5 模板**

**触发词**：`html5` + `Tab`

**目标**：

```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
</html>
```

**常用 HTML 片段**：

- `div` - div 标签
- `a` - a 链接
- `link` - link 标签
- `script` - script 标签
- `img` - img 标签
- `form` - form 表单

## 134. CSS 片段

**场景**：快速编写 CSS 样式

**Flexbox 片段**

**触发词**：`flex` + `Tab`

**目标**：

```css
display: flex;
justify-content: center;
align-items: center;
```

**Grid 片段**

**触发词**：`grid` + `Tab`

**目标**：

```css
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 1rem;
```

**常用 CSS 片段**：

- `flex` - Flexbox 布局
- `grid` - Grid 布局
- `transition` - 过渡效果
- `animation` - 动画
- `media` - 媒体查询

## 135. 自定义代码片段

**场景**：创建自己的代码片段

**LuaSnip 自定义片段示例**：

在 `~/.config/nvim/snippets/javascript.lua` 中：

```lua
local ls = require("luasnip")
local s = ls.snippet
local t = ls.text_node
local i = ls.insert_node

return {
  -- 自定义 API 调用片段
  s("apicall", {
    t("fetch('"),
    i(1, "url"),
    t("')"),
    t({ "", "  .then(response => response.json())" }),
    t({ "", "  .then(data => {" }),
    t({ "", "    " }),
    i(2, "// 处理数据"),
    t({ "", "  })" }),
    t({ "", "  .catch(error => console.error(error));" }),
  }),

  -- 自定义箭头函数
  s("arfn", {
    t("const "),
    i(1, "functionName"),
    t(" = ("),
    i(2, "params"),
    t(") => {"),
    t({ "", "  " }),
    i(3, "// 函数体"),
    t({ "", "};" }),
  }),
}
```

**触发词**：`apicall` + `Tab`

**结果**：

```javascript
fetch("url")
  .then((response) => response.json())
  .then((data) => {
    // 处理数据
  })
  .catch((error) => console.error(error));
```

## 136. Python 代码片段

**场景**：Python 开发常用片段

**主函数片段**

**触发词**：`main` + `Tab`

**目标**：

```python
def main():
    pass


if __name__ == "__main__":
    main()
```

**类定义片段**

**触发词**：`class` + `Tab`

**目标**：

```python
class ClassName:
    def __init__(self, param):
        self.param = param

    def method(self):
        pass
```

**常用 Python 片段**：

- `def` - 函数定义
- `class` - 类定义
- `ifmain` - if **name** == "**main**"
- `try` - try...except
- `with` - with 语句
- `for` - for 循环
- `while` - while 循环

## 137. 查看和管理片段

**场景**：查看可用的代码片段

**操作提示**：

**在 LazyVim 中**：

- 插入模式下 `Ctrl-Space` - 触发补全
- 可以看到可用的 snippets
- `:LuaSnipListAvailable` - 列出所有片段

**查看片段定义**：

- 片段文件位置：`~/.config/nvim/snippets/`
- 或在插件目录：`~/.local/share/nvim/lazy/friendly-snippets/snippets/`

**编辑片段**：

```vim
:e ~/.config/nvim/snippets/javascript.lua
```

## 138. Snippet 高级技巧

**场景**：使用动态片段和变量

**动态片段示例**：

```lua
-- 自动插入当前日期
s("date", {
  t(os.date("%Y-%m-%d"))
}),

-- 自动插入文件名
s("filename", {
  t(vim.fn.expand("%:t"))
}),

-- 带条件的片段
s("log", {
  t('console.log("'),
  i(1, "variable"),
  t(':", '),
  f(function(args) return args[1][1] end, {1}),
  t(");"),
}),
```

**常用变量**：

- `TM_FILENAME` - 当前文件名
- `TM_FILEPATH` - 文件完整路径
- `TM_SELECTED_TEXT` - 选中的文本
- `CURRENT_YEAR` - 当前年份
- `CURRENT_DATE` - 当前日期
