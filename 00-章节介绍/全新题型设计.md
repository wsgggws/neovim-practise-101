# Neovim 实战练习 - 全新题型设计

> 本文档展示全新的题目格式和题型类型

---

# 第一部分：全新题目格式模板

## 基础题型（标准版）

### 题目模板

````markdown
## [编号] 题目名称

> 难度：⭐ | 分类：基础编辑 | 预估时间：30秒

### 场景描述

（可选）描述实际使用场景，帮助理解为什么要学这个

### 初始状态

```text
原始代码或文本
```
````

### 目标状态

```text
期望的结果
```

### 操作方法

**方法一：推荐解法**

```vim
" 具体命令
命令
```

**方法二：备选解法**

```vim
" 另一种实现方式
备选命令
```

### 关键命令解析

| 命令   | 作用 |
| ------ | ---- |
| `命令` | 解释 |

### 常见错误

- ❌ 错误操作及原因
- ✅ 正确做法

### 进阶扩展

在基础操作上可以如何变化？

### 视频时间点

- 0:00 - 题目介绍
- 0:30 - 演示
- 2:00 - 原理讲解

````

---

# 第二部分：新增题型

## 类型一：对比题

> **目标**：理解不同方法的差异，选择最优解

```markdown
## 对比题 01：复制整行的两种方式

> 难度：⭐ | 类型：对比题 | 预估时间：1分钟

### 场景
需要复制当前行到光标下方

### 初始状态
```text
1. 第一行
2. 第二行 ← 光标在这里
3. 第三行
````

### 目标状态

```text
1. 第一行
2. 第二行
2. 第二行 ← 复制品
3. 第三行
```

### 解法对比

| 解法 | 命令  | 按键次数 | 优点       | 缺点         |
| ---- | ----- | -------- | ---------- | ------------ |
| A    | `yyp` | 3        | 简单直观   | 仅限当前行   |
| B    | `:t.` | 4        | 可指定范围 | 需要输入冒号 |

### 推荐解法

```vim
yyp
```

### 深度对比

**yyp vs :t.**

- `yy` = 复制整行到寄存器
- `p` = 粘贴到光标后
- `:t.` = 复制当前行到当前位置（t = copy to）

**使用场景**

- 快速复制：用 `yyp`
- 指定行数复制：用 `:t n`

### 检验清单

- [ ] 理解两种解法的原理
- [ ] 知道什么场景用哪个
- [ ] 能在 5 秒内完成

---

## 类型二：纠错题

> **目标**：找出常见错误，避免踩坑

````markdown
## 纠错题 01：为什么删除不工作？

> 难度：⭐⭐ | 类型：纠错题 | 预估时间：1分钟

### 场景

你想删除一个单词，但结果不对

### 初始代码

```text
hello world neovim
      ↑ 光标在这里
```
````

### 错误操作

```vim
daw
```

### 错误结果

```text
hello neovim
```

### 正确操作

```vim
diw
```

### 正确结果

```text
hello world
```

### 问题分析

| 操作  | 删除内容               | 保留内容 |
| ----- | ---------------------- | -------- |
| `diw` | inner word（单词内部） | 空格     |
| `daw` | a word（一个单词）     | 无       |

### 为什么是错的？

`daw` = delete a word，会同时删除单词**和前后的空格**

`diw` = delete inside word，只删除单词**内部**，保留空格

### 正确场景选择

| 场景               | 操作  |
| ------------------ | ----- |
| 删除单词，保留空格 | `diw` |
| 删除单词及后面空格 | `daw` |
| 删除单词及前后空格 | `daw` |

### 举一反三

```vim
" 修改时保留空格
ciw

" 修改时删除整个单词（含空格）
caw
```

### 检验清单

- [ ] 理解 `i` 和 `a` 的区别
- [ ] 能根据场景选择正确的文本对象
- [ ] 不再犯类似错误

---

## 类型三：组合题

> **目标**：学习命令组合，培养编辑思维

````markdown
## 组合题 01：多步操作完成复杂任务

> 难度：⭐⭐ | 类型：组合题 | 预估时间：2分钟

### 场景

把多行代码变成函数定义

### 初始状态

```python
def hello():
    print("Hello")
    return True
```
````

### 目标状态

```python
def hello():
    print("Hello")
    return result  # result = True
```

### 思路分析

这题需要：

1. 把 `True` 赋值给 `result`
2. 把 `return True` 改成 `return result`

### 解法步骤

**方案 A：逐行操作**

```vim
" 步骤 1：复制 True 到寄存器
yiw

" 步骤 2：在上方添加变量定义
Oresult =

" 步骤 3：粘贴
P

" 步骤 4：修改 return 语句
/True<Enter>
cwresult<Esc>
```

**方案 B：宏录制**

```vim
" 录制宏
qa
Oresult =
<Esc>P
/True<Enter>
cwresult<Esc>
j
q

" 执行
@a
```

**方案 C：substitute（推荐）**

```vim
:let @a='result' | s/True/\=@a/g
```

### 命令组合解析

| 步骤 | 命令    | 作用           |
| ---- | ------- | -------------- |
| 1    | `O`     | 在上方插入空行 |
| 2    | `P`     | 粘贴到上方     |
| 3    | `/True` | 搜索目标       |
| 4    | `cw`    | 修改单词       |

### 效率对比

| 方案 | 按键次数   | 适用场景   |
| ---- | ---------- | ---------- |
| A    | ~15        | 临时操作   |
| B    | ~10 + `@a` | 多次重复   |
| C    | ~5         | 一次性操作 |

### 检验清单

- [ ] 能分析任务，拆分成多个步骤
- [ ] 知道每个步骤用什么命令
- [ ] 能选择最高效的方案

---

## 类型四：挑战题

> **目标**：开放性思考，优化效率

````markdown
## 挑战题 01：效率大比拼

> 难度：⭐⭐⭐ | 类型：挑战题 | 预估时间：5分钟

### 场景

有 100 行类似代码需要修改，怎么做最快？

### 初始状态

```python
item1 = {"name": "apple", "price": 1}
item2 = {"name": "banana", "price": 2}
item3 = {"name": "cherry", "price": 3}
... 共 100 行
```
````

### 目标状态

```python
items = [
    {"name": "apple", "price": 1},
    {"name": "banana", "price": 2},
    {"name": "cherry", "price": 3},
    ...
]
```

### 挑战要求

1. **最少的按键次数**
2. **最清晰的思路**
3. **最不容易出错**

### 参考解法

**解法 A：列编辑**

```vim
" 步骤 1：进入列选模式
Ctrl-v

" 步骤 2：选中所有行
100j

" 步骤 3：行首插入
Iitems = [<Esc>

" 步骤 4：行尾修改
$ai]<Esc>
```

**解法 B：substitute**

```vim
:%s/^item\d\+ = /    {/
:%s/$/},/
```

**解法 C：宏 + global**

```vim
:g/^item/yank A
:let @a = "items = [\n" . @a . "\n]"
:0put =@a
:%s/\(items = \[.*\)/\1,\n]/s
```

### 效率排名

| 解法 | 按键次数 | 可读性 | 可维护性 |
| ---- | -------- | ------ | -------- |
| A    | ~10      | ⭐⭐⭐ | ⭐⭐     |
| B    | ~5       | ⭐⭐   | ⭐⭐⭐   |
| C    | ~8       | ⭐     | ⭐⭐     |

### 思考题

1. 如果需求变成「只修改前 50 行」怎么办？
2. 如果要改成 JSON 格式呢？
3. 如何验证修改正确？

### 检验清单

- [ ] 能想出至少两种解法
- [ ] 能分析各解法的优劣
- [ ] 能根据场景选择最优解

---

## 类型五：思维训练题

> **目标**：理解原理，举一反三

````markdown
## 思维训练 01：理解 Vim 的编辑哲学

> 难度：⭐⭐ | 类型：思维训练 | 预估时间：3分钟

### 问题 1：动词 + 名词

Vim 的命令遵循「动词 + 名词」模式

**动词有哪些？**

- `d` = delete（删除）
- `c` = change（修改）
- `y` = yank（复制）
- `v` = visual（可视）

**名词（文本对象）有哪些？**

- `iw` = inner word（单词内部）
- `i"` = inner quotes（引号内部）
- `ip` = inner paragraph（段落内部）

**组合练习**

| 命令  | 解释       |
| ----- | ---------- |
| `diw` | 删除单词   |
| `ciw` | 修改单词   |
| `yi"` | 复制引号内 |

**问题**：如果要「删除引号内的内容，但保留引号」，应该用什么？

<details>
<summary>答案</summary>

`di"` - delete inside quotes

</details>

### 问题 2：操作 + 动作

命令也可以「操作 + 动作」

| 命令  | 解释           |
| ----- | -------------- |
| `d$`  | 删除到行尾     |
| `d0`  | 删除到行首     |
| `dgg` | 删除到文件开头 |
| `dG`  | 删除到文件结尾 |

**问题**：如果光标在第 5 行，要删除第 1-5 行，应该用什么？

<details>
<summary>答案</summary>

`d1G` 或 `dgg`

</details>

### 问题 3：为什么 Vim 这样设计？

**问题**：为什么删除单词是 `diw` 而不是 `dw`？

**答案**：因为 `dw` = delete word，它删除从光标位置到下一个单词开头，而不是整个单词。`diw` 确保删除完整的单词。

### 举一反三

| 命令     | 普通版 | 完整版       |
| -------- | ------ | ------------ |
| 删除单词 | `dw`   | `diw`        |
| 删除行   | `dd`   | 已经是完整行 |
| 修改行   | `cc`   | 已经是完整行 |

### 检验清单

- [ ] 理解「动词 + 名词」模式
- [ ] 理解「操作 + 动作」模式
- [ ] 能推断新命令的含义

---

# 第三部分：综合练习示例

## 综合题 01：真实场景重构

> 难度：⭐⭐⭐ | 类型：综合题 | 预估时间：10分钟

### 场景描述

你在接手一个遗留项目，发现代码中有大量不规范的地方需要重构。

### 原始代码

```python
# utils.py

def calculate(x,y,z):
    result = x * y + z
    if result > 100:
        return "big"
    else:
        return "small"
    # TODO: add more cases

def process_data(data):
    for item in data:
        item["price"] = item["price"] * 1.1
    return data
```
````

### 重构目标

1. 函数 1：添加类型提示、文档字符串、简化 if
2. 函数 2：修复缩进、添加类型提示
3. 删除 TODO 注释
4. 添加适当的空行

### 重构后代码

```python
"""
Utility functions for data processing.
"""


def calculate(x: int, y: int, z: int) -> str:
    """
    Calculate a value based on input parameters.

    Args:
        x: First number
        y: Second number
        z: Third number

    Returns:
        "big" if result > 100, otherwise "small"
    """
    result = x * y + z
    if result > 100:
        return "big"
    return "small"


def process_data(data: list[dict]) -> list[dict]:
    """
    Apply a 10% price increase to all items.

    Args:
        data: List of item dictionaries with price key

    Returns:
        Updated list with increased prices
    """
    for item in data:
        item["price"] = item["price"] * 1.1
    return data
```

### 分步提示

**步骤 1：函数 1 - 类型提示**

```vim
" 光标在参数上
c i (x: int, y: int, z: int) <Esc>
```

**步骤 1：函数 1 - 文档字符串**

```vim
" 使用 neogen 插件
<leader>gf
```

**步骤 1：函数 1 - 简化 if**

```光大括号内
/return "small"<Enter>
dd
```

**步骤 2：函数 2 - 缩进修复**

```vim
Vjjj=
```

**步骤 3：删除 TODO**

```vim
:TODOHIGHLIGHT
" 或
/d TODO<Enter>dd
```

**步骤 4：添加空行**

```vim
" 在函数之间
/^def<Enter>
O<Esc>
```

### 检验清单

- [ ] 完成所有重构项
- [ ] 代码风格统一
- [ ] 添加了必要的文档

### 思考题

1. 还有哪些可以改进的地方？
2. 如果用 LSP 重构功能会怎样？

---

# 第四部分：自测与检验

## 自测题模板

```markdown
## 自测题

请说出以下命令的作用：

1. `ci(` → ******\_\_\_\_******
2. `dap` → ******\_\_\_\_******
3. `gUiw` → ******\_\_\_\_******
4. `:'<,'>t0` → ******\_\_\_\_******

<details>
<summary>答案</summary>

1. 修改括号内的内容
2. 删除一个段落
3. 把单词转大写
4. 复制选中的行到文件开头

</details>
```

---

## 学习路径建议

### 新手（第 1-3 天）

- 完成所有「⭐ 基础题」
- 重点掌握：删除、复制、粘贴

### 进阶（第 4-7 天）

- 完成「⭐⭐ 对比题、纠错题」
- 重点掌握：文本对象、替换

### 高级（第 8-14 天）

- 完成「⭐⭐⭐ 组合题、挑战题」
- 重点掌握：宏、global 命令

### 融会贯通（第 15+ 天）

- 完成「思维训练题」
- 形成自己的编辑习惯

---

> **提示**：建议配合视频学习，每种题型做 3-5 道再进入下一阶段。
